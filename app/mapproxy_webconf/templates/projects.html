%def content():
    %if demo:
      <div class="span5">
        <p class="text-error">${_('demo - you dont see all projects')}</p>
        <a href="${ get_url('create_project', demo=True) }" class="btn btn-small">${ _('Create Project') }</a>
      </div>
    %else:
      <div ng-controller="ProjectCtrl" ng-init="createURL='${ get_url('create_project') }'; deleteURL='${ get_url('delete_project') }';">
        <div class="span3">
          <form novalidate name="form">
            <div labeled="input_label" name-for="cache_name" text="${ _('Project name') }">
              <input required type="text" ng-model="project.name" id="project_name" name="project_name"/>
            </div>
            <button class="btn btn-small" ng-disabled="!form.$valid" ng-click="createProject()">${ _('Create project') }</button>
          </form>
          <span message-handler="error" message-types="project.create_error,project.delete_error"></span>
        </div>
        <div class="span5">
          %for name, data in projects.items():
            <div>
              <h3>${ _('project') }: ${name}</h3>
              <i class="icon-remove pull-right"
                 dialog="ask"
                 dialog-title="${ _('Confirm!') }"
                 dialog-text="${ _('Really remove project:') } ${name}?"
                 callback="deleteProject($event, '${name}')">
              </i>
              <h5>${ _('status mapproxy configuration') }:
              %if data['valid']:
                <span class="label label-success">${ _('valid') }</span>
              </h5>
              %else:
                <span class"alert-heading">
                  <span class="label label-warning">${ _('invalid') }</span>
                </span>
              </h5>
              <div class="alert alert-block alert-warning ">
                <p>${ _('following errors are recorded') }:</p>
                <ul>
                  %for msg in data['errors']:
                    <li>${msg}</li>
                  %end
                </ul>
              </div>
              %end
            </div>
            <a href="${ get_url('configuration', project=name) }" class="btn btn-small">
              ${ _('To configuration') } &rarr;
            </a>
          <hr>
          %end
        </div>
      </div>
    %end
% end

%def site_navbar():
  <h2 class="pull-left tab-menu-header">
    ${ _('project overview') }
  </h2>
% end

%rebase base content=content, site_navbar=site_navbar, project=get('project'), active='projects'
